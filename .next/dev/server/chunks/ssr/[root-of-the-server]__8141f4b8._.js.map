{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 34, "column": 0}, "map": {"version":3,"sources":["file:///D:/Haseeb/Projects/lead%20saas%20fb/social-media-saas/frontend-2/context/AuthContext.js"],"sourcesContent":["import { createContext, useContext, useEffect, useState } from 'react';\nimport { useRouter } from 'next/router';\n\n/**\n * AuthContext provides authentication state and helpers for the application.\n * The provider stores the current user, a loading flag, and exposes methods\n * for login, signup, logout and user refresh. Tokens are persisted in\n * localStorage to survive page reloads.\n */\nconst AuthContext = createContext();\n\n/**\n * AuthProvider wraps the application and maintains authentication state.\n * On mount it attempts to read a stored JWT from localStorage and fetch\n * the current user. Subsequent login/signup calls will update the state.\n */\nexport function AuthProvider({ children }) {\n  const router = useRouter();\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const apiBaseUrl = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:4000/api';\n\n  // Fetch the current user's profile from the backend using the stored token.\n  async function fetchMe(token, { showLoading = true } = {}) {\n    if (showLoading) setLoading(true);\n    try {\n      const res = await fetch(`${apiBaseUrl}/auth/me`, {\n        headers: { Authorization: `Bearer ${token}` },\n      });\n      if (res.ok) {\n        const data = await res.json();\n        setUser(data);\n      } else {\n        // Token invalid or expired; remove it\n        localStorage.removeItem('token');\n        setUser(null);\n      }\n    } catch (err) {\n      // Network error: keep the user null but don't crash\n      console.error('Failed to fetch current user:', err);\n      setUser(null);\n    } finally {\n      if (showLoading) setLoading(false);\n    }\n  }\n\n  async function refreshUser({ silent = true } = {}) {\n    const token = typeof window !== 'undefined' ? localStorage.getItem('token') : null;\n    if (!token) {\n      setUser(null);\n      if (!silent) {\n        setLoading(false);\n      }\n      return;\n    }\n    await fetchMe(token, { showLoading: !silent });\n  }\n\n  useEffect(() => {\n    const token = typeof window !== 'undefined' ? localStorage.getItem('token') : null;\n    if (token) {\n      fetchMe(token, { showLoading: true });\n    } else {\n      setLoading(false);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  /**\n   * Login with email and password. On success the token is stored and the\n   * current user is fetched. Throws on error so callers can show feedback.\n   */\n  async function login(email, password) {\n    const res = await fetch(`${apiBaseUrl}/auth/login`, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ email, password }),\n    });\n    const data = await res.json();\n    if (!res.ok) {\n      throw new Error(data.error || 'Login failed');\n    }\n    localStorage.setItem('token', data.token);\n    await fetchMe(data.token, { showLoading: true });\n  }\n\n  /**\n   * Register a new account. Accepts email and password. On success the\n   * returned token is stored and the current user state is set. Throws on\n   * error so callers can show feedback.\n   */\n  async function signup(email, password) {\n    const res = await fetch(`${apiBaseUrl}/auth/register`, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ email, password }),\n    });\n    const data = await res.json();\n    if (!res.ok) {\n      throw new Error(data.error || 'Registration failed');\n    }\n    localStorage.setItem('token', data.token);\n    await fetchMe(data.token, { showLoading: true });\n  }\n\n  /**\n   * Log the user out by clearing the stored token and user state. Redirect\n   * to the login page afterwards.\n   */\n  function logout() {\n    localStorage.removeItem('token');\n    setUser(null);\n    router.push('/login');\n  }\n\n  return (\n    <AuthContext.Provider value={{ user, loading, login, signup, logout, refresh: refreshUser }}>\n      {children}\n    </AuthContext.Provider>\n  );\n}\n\n// Hook for consuming the AuthContext in function components.\nexport function useAuth() {\n  const ctx = useContext(AuthContext);\n  if (!ctx) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return ctx;\n}\n"],"names":[],"mappings":";;;;;;;AAAA;AACA;;;;AAEA;;;;;CAKC,GACD,MAAM,4BAAc,IAAA,oHAAa;AAO1B,SAAS,aAAa,EAAE,QAAQ,EAAE;IACvC,MAAM,SAAS,IAAA,oIAAS;IACxB,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,+GAAQ,EAAC;IACjC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,+GAAQ,EAAC;IACvC,MAAM,aAAa,iEAAmC;IAEtD,4EAA4E;IAC5E,eAAe,QAAQ,KAAK,EAAE,EAAE,cAAc,IAAI,EAAE,GAAG,CAAC,CAAC;QACvD,IAAI,aAAa,WAAW;QAC5B,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,GAAG,WAAW,QAAQ,CAAC,EAAE;gBAC/C,SAAS;oBAAE,eAAe,CAAC,OAAO,EAAE,OAAO;gBAAC;YAC9C;YACA,IAAI,IAAI,EAAE,EAAE;gBACV,MAAM,OAAO,MAAM,IAAI,IAAI;gBAC3B,QAAQ;YACV,OAAO;gBACL,sCAAsC;gBACtC,aAAa,UAAU,CAAC;gBACxB,QAAQ;YACV;QACF,EAAE,OAAO,KAAK;YACZ,oDAAoD;YACpD,QAAQ,KAAK,CAAC,iCAAiC;YAC/C,QAAQ;QACV,SAAU;YACR,IAAI,aAAa,WAAW;QAC9B;IACF;IAEA,eAAe,YAAY,EAAE,SAAS,IAAI,EAAE,GAAG,CAAC,CAAC;QAC/C,MAAM,QAAQ,sCAAgC,0BAAgC;QAC9E,wCAAY;YACV,QAAQ;YACR,IAAI,CAAC,QAAQ;gBACX,WAAW;YACb;YACA;QACF;;;IAEF;IAEA,IAAA,gHAAS,EAAC;QACR,MAAM,QAAQ,sCAAgC,0BAAgC;QAC9E;;aAEO;YACL,WAAW;QACb;IACA,uDAAuD;IACzD,GAAG,EAAE;IAEL;;;GAGC,GACD,eAAe,MAAM,KAAK,EAAE,QAAQ;QAClC,MAAM,MAAM,MAAM,MAAM,GAAG,WAAW,WAAW,CAAC,EAAE;YAClD,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,MAAM,KAAK,SAAS,CAAC;gBAAE;gBAAO;YAAS;QACzC;QACA,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,IAAI,CAAC,IAAI,EAAE,EAAE;YACX,MAAM,IAAI,MAAM,KAAK,KAAK,IAAI;QAChC;QACA,aAAa,OAAO,CAAC,SAAS,KAAK,KAAK;QACxC,MAAM,QAAQ,KAAK,KAAK,EAAE;YAAE,aAAa;QAAK;IAChD;IAEA;;;;GAIC,GACD,eAAe,OAAO,KAAK,EAAE,QAAQ;QACnC,MAAM,MAAM,MAAM,MAAM,GAAG,WAAW,cAAc,CAAC,EAAE;YACrD,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,MAAM,KAAK,SAAS,CAAC;gBAAE;gBAAO;YAAS;QACzC;QACA,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,IAAI,CAAC,IAAI,EAAE,EAAE;YACX,MAAM,IAAI,MAAM,KAAK,KAAK,IAAI;QAChC;QACA,aAAa,OAAO,CAAC,SAAS,KAAK,KAAK;QACxC,MAAM,QAAQ,KAAK,KAAK,EAAE;YAAE,aAAa;QAAK;IAChD;IAEA;;;GAGC,GACD,SAAS;QACP,aAAa,UAAU,CAAC;QACxB,QAAQ;QACR,OAAO,IAAI,CAAC;IACd;IAEA,qBACE,qKAAC,YAAY,QAAQ;QAAC,OAAO;YAAE;YAAM;YAAS;YAAO;YAAQ;YAAQ,SAAS;QAAY;kBACvF;;;;;;AAGP;AAGO,SAAS;IACd,MAAM,MAAM,IAAA,iHAAU,EAAC;IACvB,IAAI,CAAC,KAAK;QACR,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT","debugId":null}},
    {"offset": {"line": 185, "column": 0}, "map": {"version":3,"sources":["file:///D:/Haseeb/Projects/lead%20saas%20fb/social-media-saas/frontend-2/pages/_app.js"],"sourcesContent":["import '../styles/globals.css';\nimport { AuthProvider } from '../context/AuthContext';\n\n/**\n * Custom App component that wraps every page with the AuthProvider. This\n * ensures that authentication state is available throughout the app.\n */\nexport default function MyApp({ Component, pageProps }) {\n  return (\n    <AuthProvider>\n      <Component {...pageProps} />\n    </AuthProvider>\n  );\n}"],"names":[],"mappings":";;;;;AACA;;;;AAMe,SAAS,MAAM,EAAE,SAAS,EAAE,SAAS,EAAE;IACpD,qBACE,qKAAC,+HAAY;kBACX,cAAA,qKAAC;YAAW,GAAG,SAAS;;;;;;;;;;;AAG9B","debugId":null}}]
}