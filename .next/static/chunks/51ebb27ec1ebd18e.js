(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,8394,e=>{"use strict";let t="mt-2 w-full rounded-2xl border border-white/20 bg-white/5 px-4 py-3 text-sm text-white placeholder:text-slate-500 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-500/30 disabled:cursor-not-allowed disabled:opacity-60",s=t+" min-h-[140px] resize-none",a=`${t} select-dark`;e.s(["dangerButtonClass",0,"inline-flex items-center justify-center rounded-2xl border border-rose-400/40 bg-rose-500/10 px-4 py-2 text-sm font-semibold text-rose-100 transition hover:bg-rose-500/20 disabled:cursor-not-allowed disabled:opacity-60","heroPanelClass",0,"rounded-3xl border border-white/10 bg-gradient-to-br from-slate-900/80 via-slate-900/30 to-indigo-900/20 p-8 text-slate-100 shadow-2xl shadow-slate-950/30","infoTextClass",0,"text-sm text-slate-400","inputClass",0,t,"mutedLabelClass",0,"text-sm font-medium text-slate-300","panelClass",0,"rounded-3xl border border-white/10 bg-white/5 p-6 text-slate-100 shadow-xl shadow-slate-950/20 backdrop-blur-xl","pillClass",0,"text-[0.65rem] uppercase tracking-[0.35em] text-slate-400","primaryButtonClass",0,"inline-flex items-center justify-center rounded-2xl bg-gradient-to-r from-sky-400 via-blue-500 to-indigo-500 px-4 py-3 text-sm font-semibold text-white shadow-lg shadow-sky-500/30 transition hover:brightness-105 disabled:cursor-not-allowed disabled:opacity-60","secondaryButtonClass",0,"inline-flex items-center justify-center rounded-2xl border border-white/20 bg-white/10 px-4 py-2 text-sm font-medium text-white transition hover:bg-white/20 disabled:cursor-not-allowed disabled:opacity-60","selectClass",0,t,"selectDarkClass",0,a,"statusPillMap",0,{posted:"bg-emerald-500/20 text-emerald-200",scheduled:"bg-amber-500/20 text-amber-200",failed:"bg-rose-500/20 text-rose-200"},"textareaClass",0,s])},385,e=>{"use strict";var t=e.i(1398),s=e.i(1788),a=e.i(8965),l=e.i(4714),r=e.i(7639),i=e.i(8394);let o=(0,l.default)(function(){let{refresh:e}=(0,r.useAuth)(),[l,o]=(0,s.useState)(""),[n,d]=(0,s.useState)(""),[c,h]=(0,s.useState)("instagram"),[m,x]=(0,s.useState)([]),[u,p]=(0,s.useState)(""),[b,f]=(0,s.useState)(""),[g,w]=(0,s.useState)(""),[j,y]=(0,s.useState)(!1),[N,v]=(0,s.useState)(!1),[C,S]=(0,s.useState)(null),[k,P]=(0,s.useState)(""),[F,T]=(0,s.useState)(!1),$=(0,s.useRef)(null),B=m.filter(e=>"scheduled"===e.status).length,A=m.filter(e=>"failed"===e.status).length,I=m.filter(e=>"posted"===e.status).length,_=[u&&{tone:"success",text:u},b&&{tone:"danger",text:b},g&&{tone:"danger",text:g},k&&{tone:"danger",text:k}].filter(Boolean),E={success:"border-emerald-400/30 bg-emerald-400/10 text-emerald-100",danger:"border-rose-400/30 bg-rose-500/10 text-rose-100"},U=async()=>{let e=localStorage.getItem("token");try{let t=await fetch("http://localhost:4000/api/posts",{headers:{Authorization:`Bearer ${e}`}});if(t.ok){let e=await t.json();x(e)}}catch(e){console.error("Failed to load posts",e)}};async function z(e){P(""),S(null),f(""),w("");let t=e.target.files?.[0];if(!t)return;let s=localStorage.getItem("token"),a=new FormData;a.append("media",t),v(!0);try{let e=await fetch("http://localhost:4000/api/media/upload",{method:"POST",headers:{Authorization:`Bearer ${s}`},body:a}),t=await e.json();if(!e.ok)throw Error(t.error||"Failed to upload media");S(t)}catch(e){P(e.message),S(null),$.current&&($.current.value="")}finally{v(!1)}}async function O(){w(""),p(""),f("");let t=localStorage.getItem("token"),s=l.trim();if(!s)return void w("Please enter a draft caption before using AI enhancement.");try{T(!0);let a={caption:s,platform:c};C?.url&&(a.imageUrl=C.url);let l=await fetch("http://localhost:4000/api/ai/caption/enhance",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify(a)}),r=await l.json();if(!l.ok)throw Error(r.error||"Failed to enhance caption");let i=(r.caption||"").trim();if(!i)throw Error("AI did not return an enhanced caption. Please try again.");o(i),p("Caption enhanced with AI."),await e()}catch(e){w(e.message)}finally{T(!1)}}async function D(t){if(t.preventDefault(),f(""),p(""),w(""),!C)return void f("Please upload an image or video before scheduling your post.");y(!0);let s=localStorage.getItem("token");try{let t=await fetch("http://localhost:4000/api/posts",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({caption:l,mediaUrl:C.url,mediaStoragePath:C.path,mediaMimeType:C.mimetype,scheduledFor:n||void 0,platform:c})}),a=await t.json();if(!t.ok)throw Error(a.error||"Failed to schedule post");p("posted"===a.status?"Post published successfully":"Post scheduled successfully"),o(""),d(""),h("instagram"),S(null),P(""),w(""),$.current&&($.current.value=""),await U(),await e()}catch(e){f(e.message)}finally{y(!1)}}return(0,s.useEffect)(()=>{U()},[]),(0,t.jsx)(a.default,{children:(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsx)("section",{className:i.heroPanelClass,children:(0,t.jsxs)("div",{className:"flex flex-col gap-6 lg:flex-row lg:items-center lg:justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:i.pillClass,children:"Campaign cockpit"}),(0,t.jsx)("h2",{className:"mt-4 text-4xl font-semibold text-white",children:"Post Scheduler"}),(0,t.jsx)("p",{className:"mt-3 max-w-2xl text-sm text-slate-300",children:"Monitor credits, track automation health and queue cross-network posts with a single composer."})]}),(0,t.jsx)("div",{className:"grid w-full gap-4 text-center sm:grid-cols-3 lg:w-auto",children:[{label:"Ready to post",value:B},{label:"Published",value:I},{label:"Needs attention",value:A}].map(e=>(0,t.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-white/5 px-6 py-4",children:[(0,t.jsx)("p",{className:"text-[0.65rem] uppercase tracking-[0.35em] text-slate-400",children:e.label}),(0,t.jsx)("p",{className:"mt-2 text-3xl font-semibold text-white",children:e.value})]},e.label))})]})}),_.length>0&&(0,t.jsx)("div",{className:"grid gap-3",children:_.map((e,s)=>(0,t.jsx)("div",{className:`rounded-2xl border px-4 py-3 text-sm ${E[e.tone]}`,children:e.text},`${e.text}-${s}`))}),(0,t.jsxs)("div",{className:"grid gap-6 xl:grid-cols-2",children:[(0,t.jsxs)("section",{className:`${i.panelClass} space-y-6`,children:[(0,t.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:i.pillClass,children:"Composer"}),(0,t.jsx)("h3",{className:"text-2xl font-semibold text-white",children:"Schedule a new post"})]}),(0,t.jsx)("button",{type:"button",onClick:O,disabled:F||!l.trim()||N,className:i.secondaryButtonClass,children:F?"Enhancing...":"Enhance with AI"})]}),(0,t.jsxs)("form",{onSubmit:D,className:"space-y-5",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"caption",className:i.mutedLabelClass,children:"Caption"}),(0,t.jsx)("textarea",{id:"caption",value:l,onChange:e=>{o(e.target.value),g&&w("")},required:!0,className:i.textareaClass,placeholder:"Draft your caption or paste an outline..."}),(0,t.jsx)("p",{className:`${i.infoTextClass} mt-2`,children:"AI enhancements and immediate publishes deduct credits."})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"mediaFile",className:i.mutedLabelClass,children:"Upload image or video"}),(0,t.jsx)("input",{id:"mediaFile",ref:$,type:"file",accept:"image/*,video/*",onChange:z,disabled:N,className:"mt-2 block w-full cursor-pointer rounded-2xl border border-dashed border-white/30 bg-white/5 px-4 py-3 text-sm text-slate-200 file:mr-4 file:rounded-full file:border-0 file:bg-white/20 file:px-4 file:py-2 file:text-sm file:font-semibold file:text-white hover:border-white/60"}),N&&(0,t.jsx)("p",{className:`${i.infoTextClass} mt-2`,children:"Uploading media..."}),C&&(0,t.jsxs)("div",{className:"mt-3 rounded-2xl border border-white/10 bg-white/5 p-3 text-sm text-slate-200",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-semibold text-white",children:C.originalname||C.fileName||"Uploaded asset"}),(0,t.jsxs)("p",{className:"text-xs text-slate-400",children:[null!=C.size?`${(C.size/1048576).toFixed(2)} MB`:"Size unknown"," ","- ",C.mimetype]})]}),(0,t.jsx)("button",{type:"button",onClick:function(){S(null),P(""),$.current&&($.current.value="")},className:i.dangerButtonClass,children:"Remove"})]}),C.url&&(0,t.jsx)("div",{className:"mt-3 rounded-2xl border border-white/10 bg-black/20 p-2",children:C.mimetype?.startsWith("video/")?(0,t.jsx)("video",{src:C.url,controls:!0,className:"w-full rounded-2xl"}):(0,t.jsx)("img",{src:C.url,alt:"Uploaded preview",className:"w-full rounded-2xl object-cover"})})]})]}),(0,t.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"scheduledFor",className:i.mutedLabelClass,children:"Schedule (optional)"}),(0,t.jsx)("input",{id:"scheduledFor",type:"datetime-local",value:n,onChange:e=>d(e.target.value),className:`${i.inputClass} input-datetime`})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"platform",className:i.mutedLabelClass,children:"Platform"}),(0,t.jsxs)("select",{id:"platform",value:c,onChange:e=>h(e.target.value),className:i.selectDarkClass,children:[(0,t.jsx)("option",{value:"instagram",children:"Instagram"}),(0,t.jsx)("option",{value:"facebook",children:"Facebook"})]})]})]}),(0,t.jsx)("button",{type:"submit",disabled:j,className:i.primaryButtonClass,children:j?"Submitting...":"Queue post"})]})]}),(0,t.jsxs)("section",{className:`${i.panelClass} overflow-hidden`,children:[(0,t.jsxs)("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:i.pillClass,children:"Pipeline"}),(0,t.jsx)("h3",{className:"text-2xl font-semibold text-white",children:"Your scheduled posts"})]}),(0,t.jsxs)("span",{className:"rounded-full border border-white/15 bg-white/5 px-4 py-2 text-xs text-slate-300",children:[m.length," total entries"]})]}),0===m.length?(0,t.jsx)("p",{className:`${i.infoTextClass} mt-6`,children:"No posts yet. Start by uploading creative on the left."}):(0,t.jsx)("div",{className:"mt-6 overflow-auto rounded-2xl border border-white/10",children:(0,t.jsxs)("table",{className:"min-w-full text-sm text-slate-200",children:[(0,t.jsx)("thead",{className:"text-left text-xs uppercase text-slate-400",children:(0,t.jsxs)("tr",{className:"border-b border-white/10 bg-white/5",children:[(0,t.jsx)("th",{className:"px-4 py-3 font-semibold",children:"Caption"}),(0,t.jsx)("th",{className:"px-4 py-3 font-semibold",children:"Status"}),(0,t.jsx)("th",{className:"px-4 py-3 font-semibold",children:"Media"}),(0,t.jsx)("th",{className:"px-4 py-3 font-semibold",children:"Scheduled"}),(0,t.jsx)("th",{className:"px-4 py-3 font-semibold",children:"Platform"})]})}),(0,t.jsx)("tbody",{children:m.map(e=>{var s;let a;return(0,t.jsxs)("tr",{className:"border-b border-white/5 last:border-b-0 hover:bg-white/5",children:[(0,t.jsx)("td",{className:"px-4 py-3 align-top",children:(0,t.jsx)("p",{className:"max-w-xs break-words text-slate-100",children:e.caption||"No caption"})}),(0,t.jsx)("td",{className:"px-4 py-3 align-top",children:(0,t.jsx)("span",{className:`inline-flex rounded-full px-3 py-1 text-xs font-semibold ${(a=e.status,i.statusPillMap[a]||"bg-white/10 text-white")}`,children:e.status})}),(0,t.jsx)("td",{className:"px-4 py-3 align-top",children:e.mediaUrl?(0,t.jsx)("a",{href:e.mediaUrl,target:"_blank",rel:"noopener noreferrer",className:"text-sky-300 underline-offset-2 hover:text-white hover:underline",children:"View"}):(0,t.jsx)("span",{className:"text-slate-400 text-xs",children:"None"})}),(0,t.jsx)("td",{className:"px-4 py-3 align-top",children:e.scheduledFor?(s=e.scheduledFor)?new Date(s).toLocaleString(void 0,{dateStyle:"medium",timeStyle:"short"}):"Not set":"Immediate"}),(0,t.jsx)("td",{className:"px-4 py-3 align-top capitalize",children:e.platform})]},e._id)})})]})})]})]})]})})});e.s(["default",0,o])},3182,(e,t,s)=>{let a="/post-scheduler";(window.__NEXT_P=window.__NEXT_P||[]).push([a,()=>e.r(385)]),t.hot&&t.hot.dispose(function(){window.__NEXT_P.push([a])})},8761,e=>{e.v(t=>Promise.all(["static/chunks/df56c2ef92c6043e.js"].map(t=>e.l(t))).then(()=>t(3594)))},8805,e=>{e.v(t=>Promise.all(["static/chunks/5ec9ab7aae3f3e76.js"].map(t=>e.l(t))).then(()=>t(9466)))}]);